/*!
 * Midnight.js 1.1.1
 * jQuery plugin to switch between multiple fixed header designs on the fly, so it looks in line with the content below it.
 * http://aerolab.github.io/midnight.js/
 *
 * Copyright (c) 2014 Aerolab <info@aerolab.co>
 *
 * Released under the MIT license
 * http://aerolab.github.io/midnight.js/LICENSE.txt
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(l){var s=0,a=Array.prototype.slice,n;l.cleanData=(n=l.cleanData,function(t){var e,s,i;for(i=0;null!=(s=t[i]);i++)try{(e=l._data(s,"events"))&&e.remove&&l(s).triggerHandler("remove")}catch(t){}n(t)}),l.widget=function(t,s,e){var i,n,o,r,a={},h=t.split(".")[0];return t=t.split(".")[1],i=h+"-"+t,e||(e=s,s=l.Widget),l.expr[":"][i.toLowerCase()]=function(t){return!!l.data(t,i)},l[h]=l[h]||{},n=l[h][t],o=l[h][t]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},l.extend(o,n,{version:e.version,_proto:l.extend({},e),_childConstructors:[]}),(r=new s).options=l.widget.extend({},r.options),l.each(e,function(e,i){return l.isFunction(i)?void(a[e]=(n=function(){return s.prototype[e].apply(this,arguments)},o=function(t){return s.prototype[e].apply(this,t)},function(){var t,e=this._super,s=this._superApply;return this._super=n,this._superApply=o,t=i.apply(this,arguments),this._super=e,this._superApply=s,t})):void(a[e]=i);var n,o}),o.prototype=l.widget.extend(r,{widgetEventPrefix:n&&r.widgetEventPrefix||t},a,{constructor:o,namespace:h,widgetName:t,widgetFullName:i}),n?(l.each(n._childConstructors,function(t,e){var s=e.prototype;l.widget(s.namespace+"."+s.widgetName,o,e._proto)}),delete n._childConstructors):s._childConstructors.push(o),l.widget.bridge(t,o),o},l.widget.extend=function(t){for(var e,s,i=a.call(arguments,1),n=0,o=i.length;n<o;n++)for(e in i[n])s=i[n][e],i[n].hasOwnProperty(e)&&void 0!==s&&(t[e]=l.isPlainObject(s)?l.isPlainObject(t[e])?l.widget.extend({},t[e],s):l.widget.extend({},s):s);return t},l.widget.bridge=function(o,e){var r=e.prototype.widgetFullName||o;l.fn[o]=function(s){var t="string"==typeof s,i=a.call(arguments,1),n=this;return s=!t&&i.length?l.widget.extend.apply(null,[s].concat(i)):s,t?this.each(function(){var t,e=l.data(this,r);return"instance"===s?(n=e,!1):e?l.isFunction(e[s])&&"_"!==s.charAt(0)?(t=e[s].apply(e,i))!==e&&void 0!==t?(n=t&&t.jquery?n.pushStack(t.get()):t,!1):void 0:l.error("no such method '"+s+"' for "+o+" widget instance"):l.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+s+"'")}):this.each(function(){var t=l.data(this,r);t?(t.option(s||{}),t._init&&t._init()):l.data(this,r,new e(s,this))}),n}},l.Widget=function(){},l.Widget._childConstructors=[],l.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,e){e=l(e||this.defaultElement||this)[0],this.element=l(e),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=l(),this.hoverable=l(),this.focusable=l(),e!==this&&(l.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=l(e.style?e.ownerDocument:e.document||e),this.window=l(this.document[0].defaultView||this.document[0].parentWindow)),this.options=l.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:l.noop,_getCreateEventData:l.noop,_create:l.noop,_init:l.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(l.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:l.noop,widget:function(){return this.element},option:function(t,e){var s,i,n,o=t;if(0===arguments.length)return l.widget.extend({},this.options);if("string"==typeof t)if(o={},t=(s=t.split(".")).shift(),s.length){for(i=o[t]=l.widget.extend({},this.options[t]),n=0;s.length-1>n;n++)i[s[n]]=i[s[n]]||{},i=i[s[n]];if(t=s.pop(),1===arguments.length)return void 0===i[t]?null:i[t];i[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=e}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(r,a,t){var h,d=this;"boolean"!=typeof r&&(t=a,a=r,r=!1),t?(a=h=l(a),this.bindings=this.bindings.add(a)):(t=a,a=this.element,h=this.widget()),l.each(t,function(t,e){function s(){return r||!0!==d.options.disabled&&!l(this).hasClass("ui-state-disabled")?("string"==typeof e?d[e]:e).apply(d,arguments):void 0}"string"!=typeof e&&(s.guid=e.guid=e.guid||s.guid||l.guid++);var i=t.match(/^([\w:-]*)\s*(.*)$/),n=i[1]+d.eventNamespace,o=i[2];o?h.delegate(o,n,s):a.bind(n,s)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e),this.bindings=l(this.bindings.not(t).get()),this.focusable=l(this.focusable.not(t).get()),this.hoverable=l(this.hoverable.not(t).get())},_delay:function(t,e){function s(){return("string"==typeof t?i[t]:t).apply(i,arguments)}var i=this;return setTimeout(s,e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){l(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){l(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){l(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){l(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,e,s){var i,n,o=this.options[t];if(s=s||{},(e=l.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],n=e.originalEvent)for(i in n)i in e||(e[i]=n[i]);return this.element.trigger(e,s),!(l.isFunction(o)&&!1===o.apply(this.element[0],[e].concat(s))||e.isDefaultPrevented())}},l.each({show:"fadeIn",hide:"fadeOut"},function(o,r){l.Widget.prototype["_"+o]=function(e,t,s){"string"==typeof t&&(t={effect:t});var i,n=t?!0===t||"number"==typeof t?r:t.effect||r:o;"number"==typeof(t=t||{})&&(t={duration:t}),i=!l.isEmptyObject(t),t.complete=s,t.delay&&e.delay(t.delay),i&&l.effects&&l.effects.effect[n]?e[o](t):n!==o&&e[n]?e[n](t.duration,t.easing,s):e.queue(function(t){l(this)[o](),s&&s.call(e[0]),t()})}}),l.widget}),function(h){"use strict";h.widget("aerolab.midnight",{options:{headerClass:"midnightHeader",innerClass:"midnightInner",defaultClass:"default",classPrefix:"",sectionSelector:"midnight"},_headers:{},_headerInfo:{top:0,height:0},_$sections:[],_sections:[],_scrollTop:0,_documentHeight:0,_transformMode:!1,refresh:function(){this._headerInfo={top:0,height:this.element.outerHeight()},this._$sections=h("[data-"+this.options.sectionSelector+"]:not(:hidden)"),this._sections=[],this._setupHeaders(),this.recalculate()},_create:function(){var t=this;this._scrollTop=window.pageYOffset||document.documentElement.scrollTop,this._documentHeight=h(document).height(),this._headers={},this._transformMode=this._getSupportedTransform(),this.refresh(),setInterval(function(){t._recalculateSections()},1e3),t.recalculate(),h(window).resize(function(){t.recalculate()}),this._updateHeadersLoop()},recalculate:function(){this._recalculateSections(),this._updateHeaderHeight(),this._recalculateHeaders(),this._updateHeaders()},_getSupportedTransform:function(){for(var t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<t.length;e++)if(void 0!==document.createElement("div").style[t[e]])return t[e];return!1},_getContainerHeight:function(){var t=this.element.find("> ."+this.options.headerClass),s=0,i=0,n=this;return t.length?t.each(function(){var t=h(this),e=t.find("> ."+n.options.innerClass);e.length?(e.css("bottom","auto").css("overflow","auto"),i=e.outerHeight(),e.css("bottom","0")):(t.css("bottom","auto"),i=t.outerHeight(),t.css("bottom","0")),s=s<i?i:s}):s=i=this.element.outerHeight(),s},_setupHeaders:function(){var i=this,t;this._headers[this.options.defaultClass]={};for(var e=0;e<this._$sections.length;e++){var s,n;"string"==typeof(n=h(this._$sections[e]).data(this.options.sectionSelector))&&(""!==(n=n.trim())&&(i._headers[n]={}))}this.element.css("padding-top"),this.element.css("padding-right"),this.element.css("padding-bottom"),this.element.css("padding-left"),this.element.css({position:"fixed",top:0,left:0,right:0,overflow:"hidden"}),this._updateHeaderHeight(),(t=this.element.find("> ."+this.options.headerClass)).length?t.filter("."+this.options.defaultClass).length||t.filter("."+this.options.headerClass+":first").clone(!0,!0).attr("class",this.options.headerClass+" "+this.options.defaultClass):this.element.wrapInner('<div class="'+this.options.headerClass+" "+this.options.defaultClass+'"></div>');var t,o=(t=this.element.find("> ."+this.options.headerClass)).filter("."+this.options.defaultClass).clone(!0,!0);for(var n in this._headers)if(this._headers.hasOwnProperty(n)&&void 0===this._headers[n].element){var r=t.filter("."+n);r.length?this._headers[n].element=r:this._headers[n].element=o.clone(!0,!0).removeClass(this.options.defaultClass).addClass(n).appendTo(this.element);var a={position:"absolute",overflow:"hidden",top:0,left:0,right:0,bottom:0};this._headers[n].element.css(a),!1!==this._transformMode&&this._headers[n].element.css(this._transformMode,"translateZ(0)"),this._headers[n].element.find("> ."+this.options.innerClass).length||this._headers[n].element.wrapInner('<div class="'+this.options.innerClass+'"></div>'),this._headers[n].inner=this._headers[n].element.find("> ."+this.options.innerClass),this._headers[n].inner.css(a),!1!==this._transformMode&&this._headers[n].inner.css(this._transformMode,"translateZ(0)"),this._headers[n].from="",this._headers[n].progress=0}t.each(function(){var t=h(this),e=!1;for(var s in i._headers)i._headers.hasOwnProperty(s)&&t.hasClass(s)&&(e=!0);t.find("> ."+i.options.innerClass).length||t.wrapInner('<div class="'+i.options.innerClass+'"></div>'),e?t.show():t.hide()})},_recalculateHeaders:function(){this._scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,this._scrollTop=Math.max(this._scrollTop,0),this._scrollTop=Math.min(this._scrollTop,this._documentHeight);var t=this._headerInfo.height,e=this._scrollTop+this._headerInfo.top,s=e+t;if("function"==typeof window.getComputedStyle){var i=window.getComputedStyle(this.element[0],null),n=0,o=0;if(!1!==this._transformMode&&"string"==typeof i.transform){var r=i.transform.match(/(-?[0-9\.]+)/g);null!==r&&6<=r.length&&!isNaN(parseFloat(r[5]))&&(o=parseFloat(r[5]))}0<=i.top.indexOf("px")&&!isNaN(parseFloat(i.top))&&(n=parseFloat(i.top)),e+=n+o,s+=n+o}for(var a in this._headers)this._headers.hasOwnProperty(a)&&(this._headers[a].from="",this._headers[a].progress=0);for(var h=0;h<this._sections.length;h++)s>=this._sections[h].start&&e<=this._sections[h].end&&(this._headers[this._sections[h].className].visible=!0,e>=this._sections[h].start&&s<=this._sections[h].end?(this._headers[this._sections[h].className].from="top",this._headers[this._sections[h].className].progress+=1):s>this._sections[h].end&&e<this._sections[h].end?(this._headers[this._sections[h].className].from="top",this._headers[this._sections[h].className].progress=1-(s-this._sections[h].end)/t):s>this._sections[h].start&&e<this._sections[h].start&&("top"===this._headers[this._sections[h].className].from?this._headers[this._sections[h].className].progress+=(s-this._sections[h].start)/t:(this._headers[this._sections[h].className].from="bottom",this._headers[this._sections[h].className].progress=(s-this._sections[h].start)/t)))},_updateHeaders:function(){if(void 0!==this._headers[this.options.defaultClass]){var t=0,e="";for(var s in this._headers)this._headers.hasOwnProperty(s)&&""!==!this._headers[s].from&&(t+=this._headers[s].progress,e=s);for(var i in t<1&&(""===this._headers[this.options.defaultClass].from?(this._headers[this.options.defaultClass].from="top"===this._headers[e].from?"bottom":"top",this._headers[this.options.defaultClass].progress=1-t):this._headers[this.options.defaultClass].progress+=1-t),this._headers)if(this._headers.hasOwnProperty(i)&&""!==!this._headers[i].from){var n=100*(1-this._headers[i].progress);100<=n&&(n=110),n<=-100&&(n=-110),"top"===this._headers[i].from?!1!==this._transformMode?(this._headers[i].element[0].style[this._transformMode]="translateY(-"+n+"%) translateZ(0)",this._headers[i].inner[0].style[this._transformMode]="translateY(+"+n+"%) translateZ(0)"):(this._headers[i].element[0].style.top="-"+n+"%",this._headers[i].inner[0].style.top="+"+n+"%"):!1!==this._transformMode?(this._headers[i].element[0].style[this._transformMode]="translateY(+"+n+"%) translateZ(0)",this._headers[i].inner[0].style[this._transformMode]="translateY(-"+n+"%) translateZ(0)"):(this._headers[i].element[0].style.top="+"+n+"%",this._headers[i].inner[0].style.top="-"+n+"%")}}},_recalculateSections:function(){this._documentHeight=h(document).height(),this._sections=[];for(var t=0;t<this._$sections.length;t++){var e=h(this._$sections[t]);this._sections.push({element:e,className:e.data(this.options.sectionSelector),start:e.offset().top,end:e.offset().top+e.outerHeight()})}},_updateHeaderHeight:function(){this._headerInfo.height=this._getContainerHeight(),this.element.css("height",this._headerInfo.height+"px")},_updateHeadersLoop:function(){var t=this;this._requestAnimationFrame(function(){t._updateHeadersLoop()}),this._recalculateHeaders(),this._updateHeaders()},_requestAnimationFrame:function(t){var e=e||window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};e(t)}})}(jQuery);